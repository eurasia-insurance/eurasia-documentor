<?xml version="1.0" encoding="UTF-8" ?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:comp="http://xmlns.jcp.org/jsf/composite"
	xmlns:p="http://primefaces.org/ui"
	xmlns:pe="http://primefaces.org/ui/extensions"
	xmlns:fn="http://java.sun.com/jsp/jstl/functions"
	xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
	xmlns:o="http://omnifaces.org/ui"
	template="/WEB-INF/templates/design.xhtml">


	<ui:define name="page-title">
		<h:outputText value="#{ui['name.site']}" />
	</ui:define>

	<ui:define name="page-content">

		<h:form id="form">

			<h:panelGroup styleClass="span-to-div row form-group">
				<p:outputLabel value="#{ui['label.id-number']}" for="idNumber" />
				<p:inputMask id="idNumber" value="#{documentPackage.value.idNumber}"
					mask="999 999 999 999" slotChar="&#9679;"
					placeholder="#{ui['placeholder.id-number']}"
					title="#{componentFacade.messagesFor(component)}">
					<f:converter converterId="idNumber.inputMask.converter" />
					<pe:keyFilter regEx="/[0123456789]/i" preventPaste="false" />
					<p:ajax process="@this" update="@this" />
				</p:inputMask>
			</h:panelGroup>

			<h:panelGroup styleClass="span-to-div row form-group">
				<p:fileUpload fileUploadListener="#{userActionFacade.onFileUpload}"
					mode="advanced" dragDropSupport="true" multiple="true" auto="true"
					update="@form" sizeLimit="#{configurationFacade.fileSizeLimit}"
					fileLimit="#{configurationFacade.fileCountLimit}"
					cancelLabel="#{ui['command.upload-cancel']}"
					uploadLabel="#{ui['command.upload-begin']}"
					label="#{ui['command.upload-choose']}"
					accept="#{configurationFacade.acceptTypes}" />
			</h:panelGroup>

			<h:panelGroup styleClass="span-to-div row form-group">
				<p:commandButton value="#{ui['command.send']}" process="@form"
					update="@form" />
			</h:panelGroup>

			<!-- allowTypes="/(\.|\/)(gif|jpe?g|png)$/" -->

			<!-- >> files-panel-wrapper -->
			<h:panelGroup
				styleClass="files-panel-wrapper span-to-div row form-group">

				<h:outputText value="#{ui['text.no-files']}"
					rendered="#{empty documentPackage.value.uploadedFiles}" />

				<ui:repeat var="uf" value="#{documentPackage.value.uploadedFiles}">

					<!-- >> col -->
					<h:panelGroup styleClass="col-md-3">

						<!-- >> file-wrapper -->
						<h:panelGroup styleClass="file-wrapper">

							<!-- >> icon-wrapper -->
							<h:panelGroup styleClass="icon-wrapper">

								<h:panelGroup rendered="#{not uf.type.image}"
									styleClass="fa #{uf.type.fontAwesomeClass}" />

								<o:graphicImage rendered="#{uf.type.image}" dataURI="true"
									value="#{functionFacade.thumbnail(uf, configurationFacade.thumnailWidth, configurationFacade.thumnailHeight)}" />

								<!-- 								<o:graphicImage rendered="#{uf.type.image}" dataURI="true" -->
								<!-- 									value="#{functionFacade.thumbnail(uf, configurationFacade.thumnailWidth, configurationFacade.thumnailHeight)}" -->
								<!-- 									width="#{configurationFacade.thumnailWidth}" -->
								<!-- 									height="#{configurationFacade.thumnailHeight}" /> -->

							</h:panelGroup>
							<!-- << icon-wrapper -->

							<!-- >> download-link-wrapper -->
							<h:panelGroup styleClass="caption-wrapper">

								<p:commandLink ajax="false">
									<h:outputText value="#{uf.name}" />
									<p:fileDownload value="#{functionFacade.download(uf)}"
										contentDisposition="inline" />
								</p:commandLink>

								<br />

								<h:outputText value="&amp;nbsp;" escape="false" />
								<p:commandLink ajax="false" styleClass="command fa fa-download">
									<p:fileDownload value="#{functionFacade.download(uf)}"
										contentDisposition="attachment" />
								</p:commandLink>

								<h:outputText value="&amp;nbsp;" escape="false" />
								<p:commandLink action="#{userActionFacade.doDeleteFile(uf)}"
									process="@this" update="@form"
									styleClass="command fa fa-trash-o">
								</p:commandLink>

							</h:panelGroup>
							<!-- << download-link-wrapper -->

						</h:panelGroup>
						<!-- << file-wrapper -->

					</h:panelGroup>
					<!-- << col -->

				</ui:repeat>

			</h:panelGroup>
			<!-- << files-panel-wrapper -->

		</h:form>

	</ui:define>

</ui:composition>
